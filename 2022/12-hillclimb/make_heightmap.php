<?php
// Load rows of columns
$data = array_map(
	fn($row) => str_split($row),
	//explode("\n", file_get_contents("test.txt"))
	explode("\n", file_get_contents("data.txt"))
);

// Flip to columns of rows (X/Y)
$map = array_map(
	fn($col) => array_column($data, $col),
	array_keys($data[0])
);

$im = imagecreate(count($map), count($map[0]));
$red = imagecolorallocate($im, 255, 0, 0);
$colors = [];

//$path = <<< EOD
//[[0,6],[1,6],[2,6],[3,6],[4,6],[5,6],[6,6],[7,6],[8,6],[8,7],[9,7],[10,7],[11,7],[12,7],[13,7],[14,7],[15,7],[16,7],[17,7],[18,7],[19,7],[20,7],[21,7],[22,7],[22,8],[23,8],[23,9],[24,9],[24,10],[24,11],[24,12],[24,13],[25,13],[26,13],[27,13],[28,13],[29,13],[30,13],[31,13],[32,13],[33,13],[34,13],[35,13],[36,13],[37,13],[38,13],[39,13],[40,13],[41,13],[42,13],[43,13],[44,13],[44,12],[44,11],[44,10],[44,9],[44,8],[44,7],[44,6],[44,5],[44,4],[44,3],[45,3],[46,3],[47,3],[47,2],[47,1],[47,0],[48,0],[49,0],[50,0],[51,0],[52,0],[53,0],[54,0],[55,0],[56,0],[57,0],[58,0],[59,0],[60,0],[61,0],[62,0],[63,0],[64,0],[65,0],[65,1],[65,2],[66,2],[66,3],[66,4],[67,4],[68,4],[68,5],[68,6],[68,7],[69,7],[70,7],[71,7],[72,7],[73,7],[74,7],[74,8],[74,9],[74,10],[74,11],[75,11],[76,11],[77,11],[78,11],[79,11],[80,11],[81,11],[82,11],[83,11],[84,11],[85,11],[86,11],[87,11],[88,11],[89,11],[90,11],[90,10],[90,9],[90,8],[90,7],[90,6],[91,6],[92,6],[93,6],[94,6],[95,6],[96,6],[97,6],[98,6],[99,6],[100,6],[101,6],[102,6],[103,6],[104,6],[104,5],[104,4],[104,3],[105,3],[106,3],[107,3],[108,3],[108,2],[109,2],[110,2],[111,2],[112,2],[112,3],[112,4],[112,5],[112,6],[113,6],[114,6],[115,6],[116,6],[116,7],[117,7],[118,7],[119,7],[120,7],[121,7],[122,7],[123,7],[124,7],[124,6],[124,5],[124,4],[124,3],[124,2],[125,2],[125,1],[126,1],[127,1],[127,0],[128,0],[129,0],[130,0],[131,0],[131,1],[132,1],[133,1],[134,1],[135,1],[136,1],[137,1],[138,1],[139,1],[140,1],[141,1],[142,1],[143,1],[144,1],[145,1],[146,1],[147,1],[148,1],[149,1],[149,2],[150,2],[150,3],[151,3],[152,3],[153,3],[154,3],[155,3],[155,4],[156,4],[156,5],[156,6],[156,7],[156,8],[157,8],[158,8],[159,8],[160,8],[160,9],[161,9],[161,10],[162,10],[162,11],[162,12],[163,12],[163,13],[163,14],[163,15],[163,16],[163,17],[163,18],[163,19],[163,20],[163,21],[163,22],[163,23],[163,24],[163,25],[163,26],[163,27],[163,28],[163,29],[162,29],[162,30],[161,30],[160,30],[160,31],[159,31],[158,31],[157,31],[156,31],[155,31],[155,32],[154,32],[153,32],[153,33],[152,33],[152,34],[151,34],[150,34],[150,35],[149,35],[148,35],[147,35],[146,35],[145,35],[145,34],[144,34],[144,33],[143,33],[143,32],[142,32],[142,31],[142,30],[142,29],[141,29],[141,28],[140,28],[140,27],[139,27],[139,26],[138,26],[137,26],[137,25],[136,25],[136,24],[136,23],[136,22],[136,21],[136,20],[136,19],[136,18],[137,18],[137,17],[138,17],[138,16],[139,16],[140,16],[140,15],[140,14],[141,14],[141,13],[141,12],[141,11],[141,10],[142,10],[142,9],[143,9],[143,8],[144,8],[145,8],[146,8],[147,8],[148,8],[149,8],[149,9],[150,9],[150,10],[151,10],[152,10],[153,10],[154,10],[155,10],[156,10],[157,10],[157,11],[158,11],[159,11],[159,12],[159,13],[160,13],[160,14],[160,15],[160,16],[160,17],[160,18],[160,19],[160,20],[160,21],[160,22],[160,23],[161,23],[161,24],[161,25],[161,26],[160,26],[160,27],[160,28],[159,28],[158,28],[158,29],[157,29],[156,29],[155,29],[154,29],[153,29],[152,29],[152,30],[151,30],[151,31],[150,31],[150,32],[149,32],[148,32],[147,32],[146,32],[146,31],[145,31],[145,30],[144,30],[144,29],[144,28],[144,27],[143,27],[143,26],[142,26],[142,25],[141,25],[140,25],[140,24],[139,24],[139,23],[139,22],[139,21],[139,20],[139,19],[140,19],[140,18],[141,18],[141,17],[142,17],[143,17],[143,16],[143,15],[143,14],[143,13],[143,12],[144,12],[144,11],[145,11],[146,11],[147,11],[148,11],[149,11],[149,12],[150,12],[150,13],[151,13],[152,13],[153,13],[154,13],[155,13],[156,13],[157,13],[157,14],[157,15],[157,16],[157,17],[157,18],[157,19],[157,20],[157,21],[158,21],[158,22],[158,23],[158,24],[158,25],[157,25],[157,26],[156,26],[155,26],[154,26],[153,26],[152,26],[152,27],[151,27],[151,28],[150,28],[150,29],[149,29],[148,29],[147,29],[147,28],[146,28],[146,27],[146,26],[146,25],[145,25],[145,24],[144,24],[143,24],[143,23],[142,23],[142,22],[142,21],[142,20],[142,19],[143,19],[144,19],[144,18],[145,18],[145,17],[145,16],[145,15],[146,15],[146,14],[147,14],[148,14],[149,14],[150,14],[150,15],[151,15],[152,15],[153,15],[154,15],[155,15],[155,16],[155,17],[155,18],[155,19],[155,20],[155,21],[155,22],[155,23],[155,24],[154,24],[153,24],[152,24],[151,24],[150,24],[150,25],[150,26],[149,26],[148,26],[148,25],[147,25],[147,24],[147,23],[146,23],[146,22],[146,21],[147,21],[148,21],[148,20],[147,20],[146,20]]
//EOD;

//$path = json_decode($path, true);

foreach($map as $x => $row) {
	foreach($row as $y => $height) {
		$height = match($height) {
			'S' => 'a',
			'E' => 'z',
			default => $height
		};
		
		$intensity = floor(255 * (((ord($height)-96)/26)));
		
		if(!array_key_exists($intensity, $colors))
			$colors[$intensity] = imagecolorallocate($im, $intensity, $intensity, $intensity);
		
		imagesetpixel($im, $x, $y, $colors[$intensity]);
	}
}

//foreach($path as $p) {
//	imagesetpixel($im, $p[0], $p[1], $red);
//}

$im = imagescale($im, count($map) * 5, count($map[0]) * 5, IMG_NEAREST_NEIGHBOUR);

imagepng($im, 'heightmap.png');